<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="mybatis.AdminUser">

	<select id="SelectPlannerList" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from(select t.*, rownum r from(select * from planner order by view_count)t) 
		where r between #{start} and #{end}
	</select>
	
	<select id="SelectReviewList" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from(select t.*, rownum a from(select * from member m join liked_review lr on m.id=lr.id 
		join review r on r.review_id = lr.review_id order by view_count)t) where a between #{start} and #{end}
		
	</select>
	
	
	<select id="SelectFavoriteList" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from liked_tour lt join content c on lt.contentid = c.contentid
	</select>
	
	<delete id="AdminUserInfoDelete" parameterType="java.util.Map">
		DELETE member WHERE id=#{id}
	</delete>
	
	<select id="AdminUserReservationList" resultType="AdminReservationDTO">
      SELECT r.*, m.id as id, pp.roomtitle as roomtitle, pp.p_id as p_id FROM planner p, member m, reservation r, p_product pp WHERE p.id=m.id AND 
      p.planner_id=r.planner_id AND r.roomcode=pp.roomcode
   </select>

	
	<select id="AdminUserPlannerList">
			
	</select>
	
	<select id="getTotal" parameterType="java.util.Map" resultType="int">
		select count(*) from liked_tour 
       <if test="searchColumn !=null">
    		WHERE ${searchColumn} LIKE '%' || #{searchWord} || '%'
    	</if>	
	</select>
	
	
  <select id="AdminUserInfoList" parameterType="java.util.Map" resultType="AdminUserDTO">
      SELECT * FROM MEMBER  
         <if test="gender!=null and ages==null">
            WHERE gender = #{gender}       
         </if>
         <if test="gender==null and ages!=null">
            WHERE trunc(age/10,0)*10    
            <foreach collection="ages" item="element" index="i" open="IN(" separator="," close=")">
               #{element}   
            </foreach>
         </if>
         
         <if test="ages!=null and gender!=null">
            WHERE gender=#{gender} AND trunc(age/10,0)*1
            <foreach collection="ages" item="element" index="i" open="IN(" separator="," close=")">
               #{element}    
            </foreach>
         </if>
            ORDER BY regidate
   </select>

   
   
   
   

</mapper>