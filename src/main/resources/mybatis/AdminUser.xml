<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="mybatis.AdminUser">



	<select id="SelectReviewList" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from(select t.*, rownum a from(select * from
		member m join liked_review lr on m.id=lr.id
		join review r on r.review_id = lr.review_id order by view_count)t)
		<if test="start !=null">
		 where a
		between #{start} and #{end}
		</if>
	</select>

	<delete id="AdminUserInfoDelete" parameterType="java.util.Map">
		DELETE member
		WHERE id=#{id}
	</delete>

	<select id="SelectPlannerList" parameterType="java.util.Map" resultType="AdminUserDTO">
		<if test="days !=null and days > 9">
			 select * from planner <![CDATA[ where days >= #{days} ]]> order by days desc 
		</if>
		<if test="days !=null and days lte 9">
			 select * from planner <![CDATA[ where days <= #{days} ]]> order by days desc
		</if>
		<if test="days ==null">
			select * from planner order by days desc
		</if>
	</select>
	
	<select id="AdminUserReservationList" parameterType="java.util.Map" resultType="AdminReservationDTO">
		<if test="status != null">
			select * from p_product pp join reservation r on pp.roomcode=r.roomcode
			join planner p on p.planner_id = r.planner_id       
			<if test="status!=null">
		        	where status=#{status}
			</if>
		</if>
		
		<if test="status == null">
			select * from p_product pp join reservation r on pp.roomcode=r.roomcode
			join planner p on p.planner_id = r.planner_id 
		</if>
	</select>

	<select id="hotTour" parameterType="java.util.Map" resultType="AdminUserDTO">
<!-- 		select max(viewcount) from content  -->
		select title,viewcount,firstimage from content where viewcount=(select max(viewcount) from content)
	</select>
	
	<select id="hotPlanner" parameterType="java.util.Map" resultType="AdminUserDTO">
		select id,liked from planner where id=(select max(id) from planner)
	</select>
	
	<select id="hotReview" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from review where liked = (select max(liked) as p from review)
	</select>
	


	<!--*************대쉬보드 문의 수******************** -->
	<select id="noticeCount"  parameterType="java.util.Map" resultType="int">
		select count(*) from u_ask_planit
	</select>

	<select id="genderCount" parameterType="java.util.Map" resultType="int">
			select count(gender) from member where gender='M'
	</select>
	<select id="genderCount1" parameterType="java.util.Map" resultType="int">
			select count(gender) from member where gender='F'
	</select>


	<select id="seoulCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=1
	</select>
	<select id="gyeongsangCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=4 or areacode=6 or areacode=7 or areacode=35 or areacode=36
	</select>
	<select id="incheonCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=2
	</select>
	<select id="gangwonCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=32
	</select>
	<select id="gyeonggiCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=31
	</select>
	<select id="jeollaCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=5 or areacode=37 or areacode=38
	</select>
	<select id="jejuCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=39
	</select>
	<select id="chungcheongCount" parameterType="java.util.Map" resultType="int">
		select count(areacode) from planner where areacode=3 or areacode=33 or areacode=34
	</select>
	
	
	<!--*************페이징/검색******************** -->
	<select id="getTotal" parameterType="java.util.Map" resultType="int">
		select count(*) from liked_tour
		<if test="searchColumn !=null">
			WHERE ${searchColumn} LIKE '%' || #{searchWord} || '%'
		</if>
	</select>
	
	<select id="fCount" parameterType="java.util.Map" resultType="int">
		select count(*) from liked_tour lt join member m on m.id = lt.id join content c on c.contentid = lt.contentid
		<if test="searchColumn !=null">
			WHERE ${searchColumn} LIKE '%' || #{searchWord} || '%'
		</if>
	</select>
	
	
	<!--*************대쉬보드에 총 플래너 수******************** -->
	<select id="getPlannerTotal" parameterType="java.util.Map" resultType="int">
		select count(*) from planner 
	</select>


	<!--*************대쉬보드에 총 가입자 수******************** -->
	<select id="memberCount" parameterType="java.util.Map" resultType="int">
		select count(*) from member 
	</select>	
	
	
	<!--*************대쉬보드에 총 리뷰카운트******************** -->
	<select id="reviewCount" parameterType="java.util.Map" resultType="int">
		select count(*) from review 
	</select>	
	
	
	
	<!--*************사용자 정보 값 ajax******************** -->
	<select id="AdminUserInfoList" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from member
		<if test="gender == M and age !=null ">
			 where gender='M' and age like #{ages}||'%'
		</if>
		<if test="gender == F and age !=null ">
			 where gender='F' and age like #{ages}||'%'
		</if>
	</select>



	<!--**************즐겨찾기에서 뿌려줄******************** -->
	<select id="SelectFavoriteList" parameterType="java.util.Map" resultType="AdminUserDTO">
		select * from liked_tour lt join member m on m.id = lt.id join content c on c.contentid = lt.contentid
	</select>
	
	




</mapper>